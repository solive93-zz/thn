(function(e){function t(e,t,n){var f=0,l=[0],c="",h=null,c=n||"UTF8";if("UTF8"!==c&&"UTF16"!==c)throw"encoding must be UTF8 or UTF16";if("HEX"===t){if(0!==e.length%2)throw"srcString of HEX type must be in byte increments";h=i(e);f=h.binLen;l=h.value}else if("ASCII"===t||"TEXT"===t)h=r(e,c),f=h.binLen,l=h.value;else if("B64"===t)h=s(e),f=h.binLen,l=h.value;else throw"inputFormat must be HEX, TEXT, ASCII, or B64";this.getHash=function(e,t,n,r){var i=null,s=l.slice(),c=f,h;3===arguments.length?"number"!==typeof n&&(r=n,n=1):2===arguments.length&&(n=1);if(n!==parseInt(n,10)||1>n)throw"numRounds must a integer >= 1";switch(t){case"HEX":i=o;break;case"B64":i=u;break;default:throw"format must be HEX or B64"}if("SHA-384"===e)for(h=0;h<n;h++)s=w(s,c,e),c=384;else if("SHA-512"===e)for(h=0;h<n;h++)s=w(s,c,e),c=512;else throw"Chosen SHA variant is not supported";return i(s,a(r))};this.getHMAC=function(e,t,n,h,p){var d,v,m,g,y=[],b=[];d=null;switch(h){case"HEX":h=o;break;case"B64":h=u;break;default:throw"outputFormat must be HEX or B64"}if("SHA-384"===n)v=128,g=384;else if("SHA-512"===n)v=128,g=512;else throw"Chosen SHA variant is not supported";if("HEX"===t)d=i(e),m=d.binLen,d=d.value;else if("ASCII"===t||"TEXT"===t)d=r(e,c),m=d.binLen,d=d.value;else if("B64"===t)d=s(e),m=d.binLen,d=d.value;else throw"inputFormat must be HEX, TEXT, ASCII, or B64";e=8*v;t=v/4-1;v<m/8?(d=w(d,m,n),d[t]&=4294967040):v>m/8&&(d[t]&=4294967040);for(v=0;v<=t;v+=1)y[v]=d[v]^909522486,b[v]=d[v]^1549556828;n=w(b.concat(w(y.concat(l),e+f,n)),e+g,n);return h(n,a(p))}}function n(e,t){this.a=e;this.b=t}function r(e,t){var n=[],r,i=[],s=0,o;if("UTF8"===t)for(o=0;o<e.length;o+=1)for(r=e.charCodeAt(o),i=[],2048<r?(i[0]=224|(r&61440)>>>12,i[1]=128|(r&4032)>>>6,i[2]=128|r&63):128<r?(i[0]=192|(r&1984)>>>6,i[1]=128|r&63):i[0]=r,r=0;r<i.length;r+=1)n[s>>>2]|=i[r]<<24-s%4*8,s+=1;else if("UTF16"===t)for(o=0;o<e.length;o+=1)n[s>>>2]|=e.charCodeAt(o)<<16-s%4*8,s+=2;return{value:n,binLen:8*s}}function i(e){var t=[],n=e.length,r,i;if(0!==n%2)throw"String of HEX type must be in byte increments";for(r=0;r<n;r+=2){i=parseInt(e.substr(r,2),16);if(isNaN(i))throw"String of HEX type contains invalid characters";t[r>>>3]|=i<<24-r%8*4}return{value:t,binLen:4*n}}function s(e){var t=[],n=0,r,i,s,o,u;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";r=e.indexOf("=");e=e.replace(/\=/g,"");if(-1!==r&&r<e.length)throw"Invalid '=' found in base-64 string";for(i=0;i<e.length;i+=4){u=e.substr(i,4);for(s=o=0;s<u.length;s+=1)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(u[s]),o|=r<<18-6*s;for(s=0;s<u.length-1;s+=1)t[n>>2]|=(o>>>16-8*s&255)<<24-n%4*8,n+=1}return{value:t,binLen:8*n}}function o(e,t){var n="",r=4*e.length,i,s;for(i=0;i<r;i+=1)s=e[i>>>2]>>>8*(3-i%4),n+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(s&15);return t.outputUpper?n.toUpperCase():n}function u(e,t){var n="",r=4*e.length,i,s,o;for(i=0;i<r;i+=3)for(o=(e[i>>>2]>>>8*(3-i%4)&255)<<16|(e[i+1>>>2]>>>8*(3-(i+1)%4)&255)<<8|e[i+2>>>2]>>>8*(3-(i+2)%4)&255,s=0;4>s;s+=1)n=8*i+6*s<=32*e.length?n+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-s)&63):n+t.b64Pad;return n}function a(e){var t={outputUpper:!1,b64Pad:"="};try{e.hasOwnProperty("outputUpper")&&(t.outputUpper=e.outputUpper),e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad)}catch(n){}if("boolean"!==typeof t.outputUpper)throw"Invalid outputUpper formatting option";if("string"!==typeof t.b64Pad)throw"Invalid b64Pad formatting option";return t}function f(e,t){var r=null,r=new n(e.a,e.b);return r=32>=t?new n(r.a>>>t|r.b<<32-t&4294967295,r.b>>>t|r.a<<32-t&4294967295):new n(r.b>>>t-32|r.a<<64-t&4294967295,r.a>>>t-32|r.b<<64-t&4294967295)}function l(e,t){var r=null;return r=32>=t?new n(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new n(0,e.a>>>t-32)}function c(e,t,r){return new n(e.a&t.a^~e.a&r.a,e.b&t.b^~e.b&r.b)}function h(e,t,r){return new n(e.a&t.a^e.a&r.a^t.a&r.a,e.b&t.b^e.b&r.b^t.b&r.b)}function p(e){var t=f(e,28),r=f(e,34);e=f(e,39);return new n(t.a^r.a^e.a,t.b^r.b^e.b)}function d(e){var t=f(e,14),r=f(e,18);e=f(e,41);return new n(t.a^r.a^e.a,t.b^r.b^e.b)}function v(e){var t=f(e,1),r=f(e,8);e=l(e,7);return new n(t.a^r.a^e.a,t.b^r.b^e.b)}function m(e){var t=f(e,19),r=f(e,61);e=l(e,6);return new n(t.a^r.a^e.a,t.b^r.b^e.b)}function g(e,t){var r,i,s;r=(e.b&65535)+(t.b&65535);i=(e.b>>>16)+(t.b>>>16)+(r>>>16);s=(i&65535)<<16|r&65535;r=(e.a&65535)+(t.a&65535)+(i>>>16);i=(e.a>>>16)+(t.a>>>16)+(r>>>16);return new n((i&65535)<<16|r&65535,s)}function y(e,t,r,i){var s,o,u;s=(e.b&65535)+(t.b&65535)+(r.b&65535)+(i.b&65535);o=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(i.b>>>16)+(s>>>16);u=(o&65535)<<16|s&65535;s=(e.a&65535)+(t.a&65535)+(r.a&65535)+(i.a&65535)+(o>>>16);o=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(i.a>>>16)+(s>>>16);return new n((o&65535)<<16|s&65535,u)}function b(e,t,r,i,s){var o,u,a;o=(e.b&65535)+(t.b&65535)+(r.b&65535)+(i.b&65535)+(s.b&65535);u=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(i.b>>>16)+(s.b>>>16)+(o>>>16);a=(u&65535)<<16|o&65535;o=(e.a&65535)+(t.a&65535)+(r.a&65535)+(i.a&65535)+(s.a&65535)+(u>>>16);u=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(i.a>>>16)+(s.a>>>16)+(o>>>16);return new n((u&65535)<<16|o&65535,a)}function w(e,t,r){var i,s,o,u,a,f,l,w,E,x,T,C,k,A,_,D,H,B,j,F,I,q,U,z,W,X=[],V,$=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];x=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];s=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if("SHA-384"===r||"SHA-512"===r)T=80,i=(t+128>>>10<<5)+31,A=32,_=2,W=n,D=g,H=y,B=b,j=v,F=m,I=p,q=d,z=h,U=c,$=[new W($[0],3609767458),new W($[1],602891725),new W($[2],3964484399),new W($[3],2173295548),new W($[4],4081628472),new W($[5],3053834265),new W($[6],2937671579),new W($[7],3664609560),new W($[8],2734883394),new W($[9],1164996542),new W($[10],1323610764),new W($[11],3590304994),new W($[12],4068182383),new W($[13],991336113),new W($[14],633803317),new W($[15],3479774868),new W($[16],2666613458),new W($[17],944711139),new W($[18],2341262773),new W($[19],2007800933),new W($[20],1495990901),new W($[21],1856431235),new W($[22],3175218132),new W($[23],2198950837),new W($[24],3999719339),new W($[25],766784016),new W($[26],2566594879),new W($[27],3203337956),new W($[28],1034457026),new W($[29],2466948901),new W($[30],3758326383),new W($[31],168717936),new W($[32],1188179964),new W($[33],1546045734),new W($[34],1522805485),new W($[35],2643833823),new W($[36],2343527390),new W($[37],1014477480),new W($[38],1206759142),new W($[39],344077627),new W($[40],1290863460),new W($[41],3158454273),new W($[42],3505952657),new W($[43],106217008),new W($[44],3606008344),new W($[45],1432725776),new W($[46],1467031594),new W($[47],851169720),new W($[48],3100823752),new W($[49],1363258195),new W($[50],3750685593),new W($[51],3785050280),new W($[52],3318307427),new W($[53],3812723403),new W($[54],2003034995),new W($[55],3602036899),new W($[56],1575990012),new W($[57],1125592928),new W($[58],2716904306),new W($[59],442776044),new W($[60],593698344),new W($[61],3733110249),new W($[62],2999351573),new W($[63],3815920427),new W(3391569614,3928383900),new W(3515267271,566280711),new W(3940187606,3454069534),new W(4118630271,4000239992),new W(116418474,1914138554),new W(174292421,2731055270),new W(289380356,3203993006),new W(460393269,320620315),new W(685471733,587496836),new W(852142971,1086792851),new W(1017036298,365543100),new W(1126000580,2618297676),new W(1288033470,3409855158),new W(1501505948,4234509866),new W(1607167915,987167468),new W(1816402316,1246189591)],x="SHA-384"===r?[new W(3418070365,x[0]),new W(1654270250,x[1]),new W(2438529370,x[2]),new W(355462360,x[3]),new W(1731405415,x[4]),new W(41048885895,x[5]),new W(3675008525,x[6]),new W(1203062813,x[7])]:[new W(s[0],4089235720),new W(s[1],2227873595),new W(s[2],4271175723),new W(s[3],1595750129),new W(s[4],2917565137),new W(s[5],725511199),new W(s[6],4215389547),new W(s[7],327033209)];else throw"Unexpected error in SHA-2 implementation";e[t>>>5]|=128<<24-t%32;e[i]=t;V=e.length;for(C=0;C<V;C+=A){t=x[0];i=x[1];s=x[2];o=x[3];u=x[4];a=x[5];f=x[6];l=x[7];for(k=0;k<T;k+=1)X[k]=16>k?new W(e[k*_+C],e[k*_+C+1]):H(F(X[k-2]),X[k-7],j(X[k-15]),X[k-16]),w=B(l,q(u),U(u,a,f),$[k],X[k]),E=D(I(t),z(t,i,s)),l=f,f=a,a=u,u=D(o,w),o=s,s=i,i=t,t=D(w,E);x[0]=D(t,x[0]);x[1]=D(i,x[1]);x[2]=D(s,x[2]);x[3]=D(o,x[3]);x[4]=D(u,x[4]);x[5]=D(a,x[5]);x[6]=D(f,x[6]);x[7]=D(l,x[7])}if("SHA-384"===r)e=[x[0].a,x[0].b,x[1].a,x[1].b,x[2].a,x[2].b,x[3].a,x[3].b,x[4].a,x[4].b,x[5].a,x[5].b];else if("SHA-512"===r)e=[x[0].a,x[0].b,x[1].a,x[1].b,x[2].a,x[2].b,x[3].a,x[3].b,x[4].a,x[4].b,x[5].a,x[5].b,x[6].a,x[6].b,x[7].a,x[7].b];else throw"Unexpected error in SHA-2 implementation";return e}"function"===typeof define&&typeof define.amd?define(function(){return t}):"undefined"!==typeof exports?"undefined"!==typeof module&&module.exports?module.exports=exports=t:exports=t:e.jsSHA=t})(this)